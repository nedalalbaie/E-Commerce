import{d as k,b as g,G as _,N as q,O as D,P as V,Q as E,R as M,S as v,w as O,c as P,a as i,i as l,g as t,T as y,U as h,j as r,V as Q,W as R,o as z,f as C,t as A}from"./index-c8EmFYNS.js";import{_ as G}from"./ImageUpload.vue_vue_type_script_setup_true_lang-oT0zF6Ug.js";import{u as H}from"./useQuery-diit9zOu.js";import{g as K}from"./categories-service-FJppOIfh.js";import{p as W}from"./pathToFile-C8mbCNB7.js";import{V as $}from"./VAutocomplete-8cUBUDpg.js";import{V as J,a as X}from"./filter-7s9Z3Opi.js";const Y={class:"grid md:grid-cols-2 xl:grid-cols-3 gap-x-8 gap-y-2 mt-6"},Z=i("h3",{class:"text-xl"}," قم بالضغط لرفع صورة ",-1),ee={class:"mt-8 w-1/4"},ae={class:"mt-6"},ne=k({__name:"SubCategoryForm",props:{isLoading:{type:Boolean},subCategory:{}},emits:["submit"],setup(x,{emit:T}){const a=x,S=T,m=g(null),n=g("empty"),I=_(()=>!!a.subCategory),F=_(()=>!L.value.valid||n.value=="empty"),w=q(D({name:V().min(1,"يجب إدخال إسم التصنيف "),description:V().min(1,"يجب إدخال التفاصيل  "),cat_id:E().min(1,"يجب إدخال التصنيف الأب  ")})),{handleSubmit:B,errors:d,meta:L,setValues:N}=M({validationSchema:w}),{value:u}=v("name"),{value:c}=v("description"),{value:p}=v("cat_id"),f=g({page:1,limit:50}),U=H({queryKey:["categories",f],queryFn:()=>K(f.value)});O(()=>{a.subCategory&&(N({...a.subCategory}),n.value=a.subCategory.image_path?"filled":"empty",W(a.subCategory.image_path,a.subCategory.image_path.substring(a.subCategory.image_path.lastIndexOf("/")+1)).then(s=>{m.value=s}).catch(s=>{console.error(s)}))});const b=B(s=>{S("submit",{...s,image_path:m.value})}),j=(s,e)=>{m.value=s,n.value=e};return(s,e)=>(z(),P("form",{onSubmit:e[3]||(e[3]=R((...o)=>t(b)&&t(b)(...o),["prevent"]))},[i("div",Y,[l(h,{modelValue:t(u),"onUpdate:modelValue":e[0]||(e[0]=o=>y(u)?u.value=o:null),label:"إسم التصنيف الفرعي",variant:"outlined",color:"primary",placeholder:"إسم التصنيف الفرعي","error-messages":t(d).name},null,8,["modelValue","error-messages"]),l(h,{modelValue:t(c),"onUpdate:modelValue":e[1]||(e[1]=o=>y(c)?c.value=o:null),label:"التفاصيل",type:"text",variant:"outlined",color:"primary",placeholder:"التفاصيل","error-messages":t(d).description},null,8,["modelValue","error-messages"]),l($,{modelValue:t(p),"onUpdate:modelValue":e[2]||(e[2]=o=>y(p)?p.value=o:null),"hide-no-data":!1,"item-title":"name","item-value":"id",items:t(U).data.value,loading:a.isLoading,"hide-selected":"",label:"التصنيفات",placeholder:"التصنيفات",variant:"outlined",color:"primary","auto-select-first":"","error-messages":t(d).cat_id},{"no-data":r(()=>[l(J,null,{default:r(()=>[l(X,null,{default:r(()=>[C(" لا توجد نتائج ")]),_:1})]),_:1})]),_:1},8,["modelValue","items","loading","error-messages"])]),i("div",null,[Z,i("div",ee,[l(G,{onHandleImage:j})])]),i("div",ae,[l(Q,{disabled:F.value,size:"large",variant:"elevated",color:"primary",type:"submit",loading:a.isLoading},{default:r(()=>[C(A(I.value?"تعديل":"إضافة"),1)]),_:1},8,["disabled","loading"])])],32))}});export{ne as _};
